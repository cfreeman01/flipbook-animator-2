{"version":3,"sources":["context.js","components/CompletedGIF.js","components/IconButton.js","icons/pencil.png","icons/pen.png","icons/eraser.png","icons/dropper.png","components/Toolbar.js","drawData.js","icons/undo.png","icons/redo.png","components/UndoRedoBar.js","icons/black.png","icons/white.png","icons/red.png","icons/lightred.png","icons/orange.png","icons/yellow.png","icons/green.png","icons/pink.png","icons/purple.png","icons/blue.png","components/ColorSelector.js","components/TextAndRangeSelector.js","icons/hide.png","icons/unhide.png","components/LayerMenuItem.js","icons/plus.png","icons/X.png","icons/up.png","icons/down.png","icons/copy.png","icons/paste.png","components/LayerMenu.js","components/Sidebar.js","icons/left-arrow.png","icons/right-arrow.png","gif.js","components/BottomBar.js","components/CanvasForm.js","components/Layer.js","components/DrawingArea.js","components/Flipbook.js","index.js"],"names":["FlipbookContext","React","createContext","CompletedGIF","gifSrc","useContext","globalState","setGlobalState","id","onClick","newState","Object","assign","gifOpen","src","event","stopPropagation","style","display","margin","IconButton","btnTitle","imgSrc","onClick_p","selected","size","useState","btnClass","setClass","iconClass","alt","width","height","title","className","onMouseOver","onMouseOut","onMouseDown","onMouseUp","Toolbar","setSelectedTool","toolName","selectedTool","pencilIcon","penIcon","eraserIcon","dropperIcon","oldX","oldY","midX","midY","newX","newY","isDrawing","layers","undoStack","redoStack","botCanvas","ref","undo","curFrame","curLayer","layer","length","push","imgData","newCanvasImage","pop","redo","clearUndoRedoStacks","calcSmoothPoints","tension","numSegments","t1x","t2x","t1y","t2y","st","c1","c2","c3","c4","smoothedX","smoothedY","smoothedPoints","t","Math","pow","tools","Pencil","startPath","canvas","ctx","getContext","rect","getBoundingClientRect","getImageData","clientX","left","clientY","top","draw","lineCap","lineJoin","beginPath","moveTo","i","lineTo","stroke","closePath","endPath","Pen","Eraser","tempStrokeStyle","strokeStyle","globalCompositeOperation","Dropper","x","y","window","devicePixelRatio","data","rgb","toString","ctrlPressed","UndoRedoBar","keyPress","ctrlKey","key","preventDefault","newLayerId","keyUp","useEffect","document","addEventListener","removeEventListener","undoIcon","e","redoIcon","ColorSelector","setSelectedColor","colorValue","selectedColor","blackIcon","whiteIcon","redIcon","lightRedIcon","orangeIcon","yellowIcon","greenIcon","pinkIcon","purpleIcon","blueIcon","type","onChange","target","value","TextAndRangeSelector","min","max","unit","initValue","setValue","textRef","useRef","rangeRef","validateInput","input","current","defaultValue","LayerMenuItem","name","hidden","rename","select","hide","layerClass","renderClass","imSrc","unhideIcon","hideIcon","onDoubleClick","clipboard","LayerMenu","opacity","plusIcon","unshift","xIcon","confirm","splice","upIcon","temp","downIcon","copyIcon","set","Uint8ClampedArray","pasteIcon","map","index","newName","prompt","renameLayer","selectLayer","hideLayer","Sidebar","botCanvasRight","scrollX","innerWidth","botCanvasTop","selectedSize","botCanvasOpacity","LZWEncoder","imgW","imgH","pixAry","initCodeSize","remaining","curPixel","n_bits","maxcode","g_init_bits","ClearCode","EOFCode","a_count","exports","EOF","BITS","HSIZE","maxbits","maxmaxcode","htab","codetab","hsize","free_ent","clear_flg","cur_accum","cur_bits","masks","accum","pixels","color_depth","char_out","c","outs","flush_char","cl_block","cl_hash","output","compress","init_bits","fcode","ent","disp","hsize_reg","hshift","MAXCODE","nextPixel","outer_loop","encode","os","writeByte","writeBytes","code","apply","this","arguments","NeuQuant","alphadec","thepicture","lengthcount","samplefac","network","netsize","prime1","prime2","prime3","prime4","minpicturebytes","maxnetpos","netbiasshift","ncycles","intbiasshift","intbias","gammashift","betashift","beta","betagamma","initrad","radiusbiasshift","radiusbias","initradius","radiusdec","alphabiasshift","initalpha","radbiasshift","radbias","alpharadbshift","alpharadbias","netindex","bias","freq","radpower","thepic","len","sample","p","Array","colorMap","k","l","j","inxbuild","smallpos","smallval","q","previouscol","startpos","learn","b","g","r","radius","rad","alpha","step","delta","samplepixels","pix","lim","contest","altersingle","alterneigh","unbiasnet","dist","a","bestd","best","process","lo","hi","m","n","biasdist","betafreq","bestpos","bestbiaspos","bestbiasd","framesPerSecond","BottomBar","drawFrame","frameIndex","tempCanvas","createElement","fillStyle","fillRect","lyrIndex","lyr","globalAlpha","putImageData","drawImage","leftArrowIcon","rightArrowIcon","encoder","chr","String","fromCharCode","ByteArray","bin","prototype","getData","v","val","writeUTFBytes","string","charCodeAt","array","offset","transIndex","out","image","indexedPixels","colorDepth","colorTab","transparent","repeat","delay","started","usedEntry","palSize","dispose","closeStream","firstFrame","sizeSet","comment","reset","setDelay","ms","round","setDispose","setRepeat","iter","setTransparent","setComment","addFrame","im","is_imageData","Error","ok","ImageData","setSize","console","log","getImagePixels","analyzePixels","writeLSD","writePalette","writeNetscapeExt","writeGraphicCtrlExt","writeCommentExt","writeImageDesc","writePixels","download","filename","undefined","endsWith","templink","href","URL","createObjectURL","Blob","Uint8Array","click","finish","setFrameRate","fps","setQuality","quality","w","h","start","cont","nPix","nq","findClosest","minpos","dmin","dr","dg","db","d","count","transp","WriteShort","pValue","stream","setProperties","has_start","is_first","GIFEncoder","offScreenCanvas","osctx","frame","binary_gif","data_url","btoa","CanvasForm","createCanvas_p","inputWidth","inputHeight","Layer","setImgData","zIndex","canvRef","onPointerDown","lineWidth","res","onPointerMove","onPointerUp","onPointerOut","position","scrollY","pointerEvents","visibility","DrawingArea","handleResize","_debounce","botCanvasLeft","right","hasNewData","newData","Flipbook","canvasOpen","canvasWidth","canvasHeight","Provider","App","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.5ede9e8a.chunk.js","sourcesContent":["import React from 'react'\n\nconst FlipbookContext = React.createContext();\n\nexport default FlipbookContext;","import React from 'react';\nimport FlipbookContext from '../context'\nimport './CompletedGIF.css'\n\nconst CompletedGIF = ({ gifSrc }) => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    return (\n        <div id='gifContainer'\n            onClick={() => {\n                let newState = Object.assign({}, globalState);\n                newState.gifOpen = false;\n                setGlobalState(newState);\n            }}>\n\n            <img src={gifSrc} onClick={(event) => { event.stopPropagation(); }} \n            style={{\n                display: 'table',\n                margin: 'auto'\n            }}/>\n\n        </div>\n    );\n}\n\nexport default CompletedGIF;","import React from 'react'\nimport './IconButton.css'\n\nconst IconButton = ({btnTitle, imgSrc, onClick_p, selected, size}) => {\n\n    const [btnClass, setClass] = React.useState('iconUnselected');\n\n    const iconClass = selected ? 'iconSelected' : btnClass;\n\n    return(\n        <img alt={btnTitle}\n        width={size}\n        height={size}\n        title={btnTitle} \n        src={imgSrc} \n        className={iconClass}\n        onClick={onClick_p} \n        onMouseOver={() => setClass('iconHovered')}\n        onMouseOut={() => setClass('iconUnselected')} \n        onMouseDown={() => setClass('iconSelected')} \n        onMouseUp={() => setClass('iconHovered')}/>\n    );\n}\n\nexport default IconButton;","export default __webpack_public_path__ + \"static/media/pencil.588014e8.png\";","export default __webpack_public_path__ + \"static/media/pen.373e6d9c.png\";","export default __webpack_public_path__ + \"static/media/eraser.ce11724e.png\";","export default __webpack_public_path__ + \"static/media/dropper.f62bf4e2.png\";","import React from 'react'\nimport FlipbookContext from '../context'\nimport IconButton from './IconButton'\nimport pencilIcon from '../icons/pencil.png'\nimport penIcon from '../icons/pen.png'\nimport eraserIcon from '../icons/eraser.png'\nimport dropperIcon from '../icons/dropper.png'\n\n/*toolbar on the left side of the page*/\nconst Toolbar = () => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    const setSelectedTool = (toolName) => {\n        let newState = Object.assign({}, globalState);\n        newState.selectedTool = toolName;\n        setGlobalState(newState);\n    }\n\n    return (\n        <div id=\"toolbarContainer\">\n            <IconButton btnTitle='Pencil' imgSrc={pencilIcon} onClick_p={() => setSelectedTool('Pencil')}\n                size={40} selected={globalState.selectedTool === 'Pencil'} />\n\n            <IconButton btnTitle='Pen' imgSrc={penIcon} onClick_p={() => setSelectedTool('Pen')}\n                size={40} selected={globalState.selectedTool === 'Pen'} />\n\n            <IconButton btnTitle='Eraser' imgSrc={eraserIcon} onClick_p={() => setSelectedTool('Eraser')}\n                size={40} selected={globalState.selectedTool === 'Eraser'} />\n\n            <IconButton btnTitle='Dropper' imgSrc={dropperIcon} onClick_p={() => setSelectedTool('Dropper')}\n                size={40} selected={globalState.selectedTool === 'Dropper'} />\n        </div>\n    );\n}\n\nexport default Toolbar;","/*These 3 sets of points are used to draw smoothed curves.*/\nlet oldX = 0, oldY = 0;\nlet midX = 0, midY = 0;\nlet newX = 0, newY = 0;\n\nexport let isDrawing = false;\n\nexport let layers = [[]];\n\nlet undoStack = [];\nlet redoStack = [];\n\nexport let botCanvas = {\n    ref: null\n};\n\nexport const undo = (curFrame, curLayer) => {\n    if (isDrawing) return;\n    let layer = layers[curFrame][curLayer];\n    if (undoStack.length !== 0) {\n        redoStack.push(layer.imgData);\n        let newCanvasImage = undoStack.pop();\n        layer.imgData = newCanvasImage;\n    }\n}\n\nexport const redo = (curFrame, curLayer) => {\n    if (isDrawing) return;\n    let layer = layers[curFrame][curLayer];\n    if (redoStack.length !== 0) {\n        undoStack.push(layer.imgData);\n        let newCanvasImage = redoStack.pop();\n        layer.imgData = newCanvasImage;\n    }\n}\n\nexport const clearUndoRedoStacks = () => {\n    undoStack.length = 0;\n    redoStack.length = 0;\n}\n\n/*This algorithm for drawing smoothed curves is stolen from :\nhttps://stackoverflow.com/questions/7054272/how-to-draw-smooth-curve-through-n-points-using-javascript-html5-canvas*/\nconst calcSmoothPoints = (tension, numSegments) => {\n    let smoothedPoints = [];\n    let t1x, t2x, t1y, t2y;\n    let st;\n    let c1, c2, c3, c4;\n    let smoothedX, smoothedY;\n\n    for (let t = 0; t <= numSegments; t++) {\n        //calc tension vectors\n        t1x = (midX - oldX) * tension;\n        t2x = (newX - oldX) * tension;\n\n        t1y = (midY - oldY) * tension;\n        t2y = (newY - oldY) * tension;\n\n        // calc step\n        st = t / 16;\n\n        // calc cardinals\n        c1 = 2 * Math.pow(st, 3) - 3 * Math.pow(st, 2) + 1;\n        c2 = -(2 * Math.pow(st, 3)) + 3 * Math.pow(st, 2);\n        c3 = Math.pow(st, 3) - 2 * Math.pow(st, 2) + st;\n        c4 = Math.pow(st, 3) - Math.pow(st, 2);\n\n        // calc x and y cords with common control vectors\n        smoothedX = c1 * oldX + c2 * midX + c3 * t1x + c4 * t2x;\n        smoothedY = c1 * oldY + c2 * midY + c3 * t1y + c4 * t2y;\n\n        //store points in array\n        smoothedPoints.push(smoothedX);\n        smoothedPoints.push(smoothedY);\n    }\n    return smoothedPoints;\n}\n\nexport let tools = {\n    Pencil: {\n        startPath: (event, canvas) => {\n            let ctx = canvas.getContext('2d');\n            let rect = canvas.getBoundingClientRect();\n            undoStack.push(ctx.getImageData(0, 0, canvas.width, canvas.height));\n            redoStack.length = 0;\n            isDrawing = true;\n            oldX = midX = event.clientX - rect.left;\n            oldY = midY = event.clientY - rect.top;\n        },\n\n        draw: (event, canvas) => {\n            let rect = canvas.getBoundingClientRect();\n            let ctx = canvas.getContext('2d');\n            newX = event.clientX - rect.left;\n            newY = event.clientY - rect.top;\n            ctx.lineCap = \"round\";\n            ctx.lineJoin = \"round\";\n            if (isDrawing === true) {\n\n                /*calculate the points of the smoothed curve*/\n                let smoothedPoints = calcSmoothPoints(0.5, 16);\n\n                /*draw the curve*/\n                ctx.beginPath();\n                ctx.moveTo(smoothedPoints[0], smoothedPoints[1]);\n                for (let i = 2; i < smoothedPoints.length - 1; i += 2)\n                    ctx.lineTo(smoothedPoints[i], smoothedPoints[i + 1]);\n\n                ctx.stroke();\n                ctx.closePath();\n\n                oldX = midX;\n                oldY = midY;\n                midX = newX;\n                midY = newY;\n            }\n        },\n\n        endPath: () => {\n            isDrawing = false;\n        }\n    },\n\n    Pen: {\n        startPath: (event, canvas) => {\n            let ctx = canvas.getContext('2d');\n            let rect = canvas.getBoundingClientRect();\n            undoStack.push(ctx.getImageData(0, 0, canvas.width, canvas.height));\n            redoStack.length = 0;\n            isDrawing = true;\n            oldX = midX = event.clientX - rect.left;\n            oldY = midY = event.clientY - rect.top;\n        },\n\n        draw: (event, canvas) => {\n            let rect = canvas.getBoundingClientRect();\n            let ctx = canvas.getContext('2d');\n            newX = event.clientX - rect.left;\n            newY = event.clientY - rect.top;\n            let smoothedPoints = [];\n            ctx.lineCap = \"square\";\n            ctx.lineJoin = \"square\";\n            if (isDrawing === true) {\n\n                /*calculate the points of the smoothed curve*/\n                let smoothedPoints = calcSmoothPoints(0.5, 16);\n\n                /*draw the curve*/\n                ctx.beginPath();\n                ctx.moveTo(smoothedPoints[0] - 2, smoothedPoints[1] - 1);\n                for (let i = 2; i < smoothedPoints.length - 1; i += 2)\n                    ctx.lineTo(smoothedPoints[i] - 2, smoothedPoints[i + 1] - 1);\n\n                ctx.moveTo(smoothedPoints[0], smoothedPoints[1]);\n                for (let i = 2; i < smoothedPoints.length - 1; i += 2)\n                    ctx.lineTo(smoothedPoints[i] - 1, smoothedPoints[i + 1] - 1);\n\n                ctx.moveTo(smoothedPoints[0] + 1, smoothedPoints[1] + 1);\n                for (let i = 2; i < smoothedPoints.length - 1; i += 2)\n                    ctx.lineTo(smoothedPoints[i], smoothedPoints[i + 1]);\n\n                ctx.moveTo(smoothedPoints[0] + 2, smoothedPoints[1] + 2);\n                for (let i = 2; i < smoothedPoints.length - 1; i += 2)\n                    ctx.lineTo(smoothedPoints[i] + 2, smoothedPoints[i + 1] + 2);\n\n                ctx.stroke();\n                ctx.closePath();\n\n                oldX = midX;\n                oldY = midY;\n                midX = newX;\n                midY = newY;\n            }\n        },\n\n        endPath: () => {\n            isDrawing = false;\n        }\n    },\n\n    Eraser: {\n        startPath: (event, canvas) => {\n            let ctx = canvas.getContext('2d');\n            let rect = canvas.getBoundingClientRect();\n            undoStack.push(ctx.getImageData(0, 0, canvas.width, canvas.height));\n            redoStack.length = 0;\n            isDrawing = true;\n            oldX = midX = event.clientX - rect.left;\n            oldY = midY = event.clientY - rect.top;\n        },\n\n        draw: (event, canvas) => {\n            let rect = canvas.getBoundingClientRect();\n            let ctx = canvas.getContext('2d');\n            newX = event.clientX - rect.left;\n            newY = event.clientY - rect.top;\n            ctx.lineCap = \"round\";\n            ctx.lineJoin = \"round\";\n            if (isDrawing === true) {\n                let tempStrokeStyle = ctx.strokeStyle;\n                ctx.strokeStyle = 'rgba(255,255,255,1)';\n                ctx.globalCompositeOperation = \"destination-out\";\n\n                /*calculate the points of the smoothed curve*/\n                let smoothedPoints = calcSmoothPoints(0.5, 16);\n\n                /*draw the curve*/\n                ctx.beginPath();\n                ctx.moveTo(smoothedPoints[0], smoothedPoints[1]);\n                for (let i = 2; i < smoothedPoints.length - 1; i += 2)\n                    ctx.lineTo(smoothedPoints[i], smoothedPoints[i + 1]);\n\n                ctx.stroke();\n                ctx.closePath();\n\n                oldX = midX;\n                oldY = midY;\n                midX = newX;\n                midY = newY;\n                ctx.strokeStyle = tempStrokeStyle;\n                ctx.globalCompositeOperation = \"source-over\";\n            }\n        },\n\n        endPath: () => {\n            isDrawing = false;\n        }\n    },\n\n    Dropper: {\n        startPath: function (event, canvas) { //get color at x,y coordinate on main canvas\n            let rect = canvas.getBoundingClientRect();\n            let ctx = canvas.getContext('2d');\n            let x = event.clientX - rect.left;\n            let y = event.clientY - rect.top;\n            let imgData = ctx.getImageData(x * window.devicePixelRatio, y * window.devicePixelRatio, 1, 1).data;\n            let rgb = [];\n            for (let i = 0; i < 3; i++) {\n                rgb[i] = imgData[i].toString(16);\n                if (rgb[i].length === 1) rgb[i] = '0' + rgb[i];\n            }\n            let newColor = '#' + rgb[0] + rgb[1] + rgb[2];\n            return newColor;\n        },\n\n        draw: function (event) {\n\n        },\n\n        endPath: function () {\n\n        }\n    }\n}","export default __webpack_public_path__ + \"static/media/undo.eb7626ba.png\";","export default __webpack_public_path__ + \"static/media/redo.b5eb995b.png\";","import React from 'react'\nimport FlipbookContext from '../context'\nimport { undo, redo } from '../drawData'\nimport IconButton from './IconButton'\nimport undoIcon from '../icons/undo.png'\nimport redoIcon from '../icons/redo.png'\n\nlet ctrlPressed = false;\n\nconst UndoRedoBar = () => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    const keyPress = (event) => {\n        if (event.ctrlKey === true) ctrlPressed = true;\n\n        if (event.key === 'z' && ctrlPressed == true) {\n            event.preventDefault();\n            undo(globalState.curFrame, globalState.curLayer);\n            let newState = Object.assign({}, globalState);\n            newState.newLayerId++;\n            setGlobalState(newState);\n        }\n\n        if (event.key === 'y' && ctrlPressed == true) {\n            event.preventDefault();\n            redo(globalState.curFrame, globalState.curLayer);\n            let newState = Object.assign({}, globalState);\n            newState.newLayerId++;\n            setGlobalState(newState);\n        }\n    }\n\n    const keyUp = (event) => {\n        if (event.key === 'Control')\n            ctrlPressed = false;\n    }\n\n    React.useEffect(() => {\n        document.addEventListener(\"keydown\", keyPress);\n        document.addEventListener(\"keyup\", keyUp);\n\n        return () => {\n            document.removeEventListener(\"keydown\", keyPress);\n            document.removeEventListener(\"keyup\", keyUp);\n        }\n    });\n\n    return (\n        <div>\n            <IconButton btnTitle='Undo' imgSrc={undoIcon}\n                onClick_p={(e) => {\n                    undo(globalState.curFrame, globalState.curLayer);\n                    let newState = Object.assign({}, globalState);\n                    newState.newLayerId++;\n                    setGlobalState(newState);\n                }}\n                size={40} selected={false} />\n\n            <IconButton btnTitle='Redo' imgSrc={redoIcon}\n                onClick_p={(e) => {\n                    redo(globalState.curFrame, globalState.curLayer);\n                    let newState = Object.assign({}, globalState);\n                    newState.newLayerId++;\n                    setGlobalState(newState);\n                }}\n                size={40} selected={false} />\n        </div>\n    );\n}\n\nexport default UndoRedoBar;","export default __webpack_public_path__ + \"static/media/black.1fd5be43.png\";","export default __webpack_public_path__ + \"static/media/white.f637800e.png\";","export default __webpack_public_path__ + \"static/media/red.d9268b17.png\";","export default __webpack_public_path__ + \"static/media/lightred.b2e9f841.png\";","export default __webpack_public_path__ + \"static/media/orange.7ab39e4f.png\";","export default __webpack_public_path__ + \"static/media/yellow.259f7955.png\";","export default __webpack_public_path__ + \"static/media/green.71014684.png\";","export default __webpack_public_path__ + \"static/media/pink.2a087a8e.png\";","export default __webpack_public_path__ + \"static/media/purple.5c807439.png\";","export default __webpack_public_path__ + \"static/media/blue.d0223170.png\";","import React from 'react'\nimport FlipbookContext from '../context'\nimport './ColorSelector.css'\nimport _debounce from 'lodash.debounce'\nimport IconButton from './IconButton'\nimport blackIcon from '../icons/black.png'\nimport whiteIcon from '../icons/white.png'\nimport redIcon from '../icons/red.png'\nimport lightRedIcon from '../icons/lightred.png'\nimport orangeIcon from '../icons/orange.png'\nimport yellowIcon from '../icons/yellow.png'\nimport greenIcon from '../icons/green.png'\nimport pinkIcon from '../icons/pink.png'\nimport purpleIcon from '../icons/purple.png'\nimport blueIcon from '../icons/blue.png'\n\nconst ColorSelector = () => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    const setSelectedColor = (colorValue) => {\n        let newState = Object.assign({}, globalState);\n        newState.selectedColor = colorValue;\n        setGlobalState(newState);\n    }\n\n    return (\n        <div id='colorSelectorContainer'>\n            <IconButton btnTitle='Black' imgSrc={blackIcon} onClick_p={() => { setSelectedColor('#000000') }}\n                size={32} selected={globalState.selectedColor === '#000000'} />\n\n            <IconButton btnTitle='White' imgSrc={whiteIcon} onClick_p={() => { setSelectedColor('#ffffff') }}\n                size={32} selected={globalState.selectedColor === '#ffffff'} />\n\n            <IconButton btnTitle='Red' imgSrc={redIcon} onClick_p={() => { setSelectedColor('#ff0000') }}\n                size={32} selected={globalState.selectedColor === '#ff0000'} />\n\n            <IconButton btnTitle='Light red' imgSrc={lightRedIcon} onClick_p={() => { setSelectedColor('#f85e43') }}\n                size={32} selected={globalState.selectedColor === '#f85e43'} />\n\n            <IconButton btnTitle='Orange' imgSrc={orangeIcon} onClick_p={() => { setSelectedColor('#f39127') }}\n                size={32} selected={globalState.selectedColor === '#f39127'} />\n\n            <IconButton btnTitle='Yellow' imgSrc={yellowIcon} onClick_p={() => { setSelectedColor('#f3c327') }}\n                size={32} selected={globalState.selectedColor === '#f3c327'} />\n\n            <IconButton btnTitle='Green' imgSrc={greenIcon} onClick_p={() => { setSelectedColor('#34a234') }}\n                size={32} selected={globalState.selectedColor === '#34a234'} />\n\n            <IconButton btnTitle='Pink' imgSrc={pinkIcon} onClick_p={() => { setSelectedColor('#f74579') }}\n                size={32} selected={globalState.selectedColor === '#f74579'} />\n\n            <IconButton btnTitle='Purple' imgSrc={purpleIcon} onClick_p={() => { setSelectedColor('#8d00cf') }}\n                size={32} selected={globalState.selectedColor === '#8d00cf'} />\n\n            <IconButton btnTitle='Blue' imgSrc={blueIcon} onClick_p={() => { setSelectedColor('#4376f8') }}\n                size={32} selected={globalState.selectedColor === '#4376f8'} />\n\n            <input type=\"color\" id=\"colorPicker\"\n                onChange={(e) => {\n                    setSelectedColor(e.target.value);\n                }} />\n        </div>\n    );\n}\n\nexport default ColorSelector;","import React from 'react'\nimport './TextAndRangeSelector.css'\n\n/*a number input field with a range input field next to it, both kept in sync and \nenforcing min and max values*/\nconst TextAndRangeSelector = ({min, max, unit, initValue, setValue}) => {\n\n    const textRef = React.useRef();\n    const rangeRef = React.useRef();\n\n    const validateInput = (input) => {\n        if (!input) return;\n        if (input < min)\n            input = min;\n        if (input > max)\n            input = max;\n        textRef.current.value = input;\n        rangeRef.current.value = input;\n\n        setValue(input);\n    }\n\n    return (\n        <div id='selectorContainer'>\n            <input type='number' id='selectorText' defaultValue={initValue} ref={textRef}\n                onChange={(e) => validateInput(e.target.value)} />\n            <p>  {unit}</p>\n            <input type='range' id='selectorRange' defaultValue={initValue} ref={rangeRef}\n                onChange={(e) => validateInput(e.target.value)} />\n        </div>\n    );\n}\n\nexport default TextAndRangeSelector;","export default __webpack_public_path__ + \"static/media/hide.2a8a0743.png\";","export default __webpack_public_path__ + \"static/media/unhide.e6ff1808.png\";","import React from 'react'\nimport IconButton from './IconButton'\nimport './LayerMenuItem.css'\nimport hideIcon from '../icons/hide.png'\nimport unhideIcon from '../icons/unhide.png'\n\nconst LayerMenuItem = ({ name, selected, hidden, rename, select, hide }) => {\n\n    const [layerClass, setClass] = React.useState('layerMenuItemUnselected');\n\n    const renderClass = selected ? 'layerMenuItemSelected' : layerClass;\n    const title = hidden ? 'Unhide Layer' : 'Hide Layer';\n    const imSrc = hidden ? unhideIcon : hideIcon;\n\n    return (\n        <div className={renderClass} onClick={select}\n            onMouseOver={() => setClass('layerMenuItemHovered')}\n            onMouseOut={() => setClass('layerMenuItemUnselected')}>\n\n            <IconButton btnTitle={title} imgSrc={imSrc} size={28} selected={false}\n                onClick_p={(e) => { e.stopPropagation(); hide(); }} />\n\n            <span id='layerName' onDoubleClick={rename}>{name}</span>\n\n        </div>\n    );\n}\n\nexport default LayerMenuItem;","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/X.d73ecd37.png\";","export default __webpack_public_path__ + \"static/media/up.7d9ac618.png\";","export default __webpack_public_path__ + \"static/media/down.c8a3bbaa.png\";","export default __webpack_public_path__ + \"static/media/copy.01dda647.png\";","export default __webpack_public_path__ + \"static/media/paste.b7884835.png\";","import React from 'react'\nimport FlipbookContext from '../context'\nimport { layers, clearUndoRedoStacks } from '../drawData'\nimport IconButton from './IconButton'\nimport TextAndRangeSelector from './TextAndRangeSelector'\nimport LayerMenuItem from './LayerMenuItem'\nimport './LayerMenu.css'\nimport plusIcon from '../icons/plus.png'\nimport xIcon from '../icons/X.png'\nimport upIcon from '../icons/up.png'\nimport downIcon from '../icons/down.png'\nimport copyIcon from '../icons/copy.png'\nimport pasteIcon from '../icons/paste.png'\n\nlet clipboard = 'empty';\n\nconst LayerMenu = () => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    React.useEffect(() => {\n        layers[0].push({\n            id: 0,\n            imgData: null,\n            hidden: false,\n            name: 'Layer 0',\n            opacity: 100\n        });\n    }, []);\n\n    /*This function actually toggles the 'hidden' status of the layer*/\n    const hideLayer = (index) => {\n        let newState = Object.assign({}, globalState);\n        layers[globalState.curFrame][index].hidden = !layers[globalState.curFrame][index].hidden;\n        newState.newLayerId++;\n        setGlobalState(newState);\n    }\n\n    const selectLayer = (index) => {\n        let newState = Object.assign({}, globalState);\n        newState.curLayer = index;\n        setGlobalState(newState);\n        clearUndoRedoStacks();\n    }\n\n    const renameLayer = (index) => {\n        let newState = Object.assign({}, globalState);\n        let newName = prompt(\"Rename layer:\", layers[globalState.curFrame][index].name);\n        if (!(newName == \"\" || newName == null)) {\n            layers[globalState.curFrame][index].name = newName;\n        }\n        newState.newLayerId++;\n        setGlobalState(newState);\n    }\n\n    const addLayer = () => {\n        let newState = Object.assign({}, globalState);\n\n        layers[globalState.curFrame].unshift({\n            id: globalState.newLayerId,\n            imgData: null,\n            hidden: false,\n            name: 'Layer ' + globalState.newLayerId,\n            opacity: 100\n        });\n\n        newState.curLayer++;\n        newState.newLayerId++;\n        setGlobalState(newState);\n        clearUndoRedoStacks();\n    }\n\n    const removeLayer = () => {\n        if (layers[globalState.curFrame].length === 1) return;\n        if (!window.confirm('Permanently delete this layer?')) return;\n\n        let newState = Object.assign({}, globalState);\n\n        layers[globalState.curFrame].splice(globalState.curLayer, 1);\n        if (globalState.curLayer === layers[globalState.curFrame].length)\n            newState.curLayer--;\n\n        newState.newLayerId++;\n        setGlobalState(newState);\n        clearUndoRedoStacks();\n    }\n\n    const moveLayerUp = () => {\n        if (globalState.curLayer === 0) return;\n        let newState = Object.assign({}, globalState);\n\n        let temp = layers[globalState.curFrame][globalState.curLayer];\n        layers[globalState.curFrame][globalState.curLayer] = layers[globalState.curFrame][globalState.curLayer - 1];\n        layers[globalState.curFrame][globalState.curLayer - 1] = temp;\n        newState.curLayer--;\n\n        setGlobalState(newState);\n    }\n\n    const moveLayerDown = () => {\n        if (globalState.curLayer === layers[globalState.curFrame].length - 1) return;\n        let newState = Object.assign({}, globalState);\n\n        let temp = layers[globalState.curFrame][globalState.curLayer];\n        layers[globalState.curFrame][globalState.curLayer] = layers[globalState.curFrame][globalState.curLayer + 1];\n        layers[globalState.curFrame][globalState.curLayer + 1] = temp;\n        newState.curLayer++;\n\n        setGlobalState(newState);\n    }\n\n    const setLayerOpacity = (value) => {\n        layers[globalState.curFrame][globalState.curLayer].opacity = value;\n        let newState = Object.assign({}, globalState);\n        newState.newLayerId++;\n        setGlobalState(newState);\n    }\n\n    const copyLayer = () => {\n        clipboard = layers[globalState.curFrame][globalState.curLayer].imgData;\n        clipboard.data.set(new Uint8ClampedArray(layers[globalState.curFrame][globalState.curLayer].imgData.data));\n    }\n\n    const pasteLayer = () => {\n        let newState = Object.assign({}, globalState);\n        let newData = clipboard;\n        newData.data.set(new Uint8ClampedArray(clipboard.data));\n        layers[globalState.curFrame].unshift({\n            id: globalState.newLayerId,\n            imgData: clipboard,\n            hidden: false,\n            name: 'Pasted Layer',\n            opacity: 100\n        });\n        newState.curLayer++;\n        newState.newLayerId++;\n        setGlobalState(newState);\n    }\n\n    return (\n        <div id='layerMenuContainer'>\n\n            <h2>Current Layer Opacity</h2>\n            <TextAndRangeSelector min={0} max={100} unit='%' initValue={100} setValue={setLayerOpacity} />\n\n            <IconButton btnTitle='Add layer at top' imgSrc={plusIcon} onClick_p={addLayer}\n                size={28} selected={false} />\n\n            <IconButton btnTitle='Remove current layer' imgSrc={xIcon} onClick_p={removeLayer}\n                size={28} selected={false} />\n\n            <IconButton btnTitle='Move current layer up' imgSrc={upIcon} onClick_p={moveLayerUp}\n                size={28} selected={false} />\n\n            <IconButton btnTitle='Move current layer down' imgSrc={downIcon} onClick_p={moveLayerDown}\n                size={28} selected={false} />\n\n            <IconButton btnTitle='Copy current layer' imgSrc={copyIcon} onClick_p={copyLayer}\n                size={28} selected={false} />\n\n            <IconButton btnTitle='Paste layer' imgSrc={pasteIcon} onClick_p={pasteLayer}\n                size={28} selected={false} />\n\n            {layers[globalState.curFrame].map(({ id, imgData, hidden, name }, index) =>\n                <LayerMenuItem\n                    key={id}\n                    name={name}\n                    selected={globalState.curLayer === index}\n                    hidden={hidden}\n                    rename={() => renameLayer(index)}\n                    select={() => selectLayer(index)}\n                    hide={() => hideLayer(index)}\n                />)}\n\n        </div>\n    );\n}\n\nexport default LayerMenu;","import React from 'react'\nimport FlipbookContext from '../context'\nimport ColorSelector from './ColorSelector'\nimport TextAndRangeSelector from './TextAndRangeSelector'\nimport LayerMenu from './LayerMenu'\nimport './Sidebar.css'\n\nconst Sidebar = () => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    const setSelectedSize = (size) => {\n        let newState = Object.assign({}, globalState);\n        newState.selectedSize = size;\n        setGlobalState(newState);\n    }\n\n    const setLastFrameOpacity = (value) => {\n        let newState = Object.assign({}, globalState);\n        newState.botCanvasOpacity = value;\n        setGlobalState(newState);\n    }\n\n    return (\n        <div id='sidebarContainer'\n            style={{\n                left: globalState.botCanvasRight + window.scrollX >= window.innerWidth - 190 ?\n                      globalState.botCanvasRight + 15 + window.scrollX : window.innerWidth - 190,\n                top:  globalState.botCanvasTop\n            }}>\n\n            <h1>Brush Color</h1>\n            <ColorSelector />\n            <h1>Brush Size</h1>\n            <TextAndRangeSelector min={1} max={100} unit='px' initValue={1} setValue={setSelectedSize} />\n            <h1>Last Frame Opacity</h1>\n            <TextAndRangeSelector min={0} max={100} unit='%' initValue={20} setValue={setLastFrameOpacity} />\n            <h1>Layers</h1>\n            <LayerMenu />\n        </div>\n    );\n}\n\nexport default Sidebar;","export default __webpack_public_path__ + \"static/media/left-arrow.80e904ad.png\";","export default __webpack_public_path__ + \"static/media/right-arrow.610490a6.png\";","/**\n * This class handles LZW encoding\n * Adapted from Jef Poskanzer's Java port by way of J. M. G. Elliott.\n * @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n * @author Thibault Imbert (AS3 version - bytearray.org)\n * @author Kevin Kwok (JavaScript version - https://github.com/antimatter15/jsgif)\n * @version 0.1 AS3 implementation\n */\n\n let LZWEncoder = function() {\n\n\tvar exports = {};\n\tvar EOF = -1;\n\tvar imgW;\n\tvar imgH;\n\tvar pixAry;\n\tvar initCodeSize;\n\tvar remaining;\n\tvar curPixel;\n\n\t// GIFCOMPR.C - GIF Image compression routines\n\t// Lempel-Ziv compression based on 'compress'. GIF modifications by\n\t// David Rowley (mgardi@watdcsu.waterloo.edu)\n\t// General DEFINEs\n\n\tvar BITS = 12;\n\tvar HSIZE = 5003; // 80% occupancy\n\n\t// GIF Image compression - modified 'compress'\n\t// Based on: compress.c - File compression ala IEEE Computer, June 1984.\n\t// By Authors: Spencer W. Thomas (decvax!harpo!utah-cs!utah-gr!thomas)\n\t// Jim McKie (decvax!mcvax!jim)\n\t// Steve Davies (decvax!vax135!petsd!peora!srd)\n\t// Ken Turkowski (decvax!decwrl!turtlevax!ken)\n\t// James A. Woods (decvax!ihnp4!ames!jaw)\n\t// Joe Orost (decvax!vax135!petsd!joe)\n\n\tvar n_bits; // number of bits/code\n\tvar maxbits = BITS; // user settable max # bits/code\n\tvar maxcode; // maximum code, given n_bits\n\tvar maxmaxcode = 1 << BITS; // should NEVER generate this code\n\tvar htab = [];\n\tvar codetab = [];\n\tvar hsize = HSIZE; // for dynamic table sizing\n\tvar free_ent = 0; // first unused entry\n\n\t// block compression parameters -- after all codes are used up,\n\t// and compression rate changes, start over.\n\n\tvar clear_flg = false;\n\n\t// Algorithm: use open addressing double hashing (no chaining) on the\n\t// prefix code / next character combination. We do a variant of Knuth's\n\t// algorithm D (vol. 3, sec. 6.4) along with G. Knott's relatively-prime\n\t// secondary probe. Here, the modular division first probe is gives way\n\t// to a faster exclusive-or manipulation. Also do block compression with\n\t// an adaptive reset, whereby the code table is cleared when the compression\n\t// ratio decreases, but after the table fills. The variable-length output\n\t// codes are re-sized at this point, and a special CLEAR code is generated\n\t// for the decompressor. Late addition: construct the table according to\n\t// file size for noticeable speed improvement on small files. Please direct\n\t// questions about this implementation to ames!jaw.\n\n\tvar g_init_bits;\n\tvar ClearCode;\n\tvar EOFCode;\n\n\t// output\n\t// Output the given code.\n\t// Inputs:\n\t// code: A n_bits-bit integer. If == -1, then EOF. This assumes\n\t// that n_bits =< wordsize - 1.\n\t// Outputs:\n\t// Outputs code to the file.\n\t// Assumptions:\n\t// Chars are 8 bits long.\n\t// Algorithm:\n\t// Maintain a BITS character long buffer (so that 8 codes will\n\t// fit in it exactly). Use the VAX insv instruction to insert each\n\t// code in turn. When the buffer fills up empty it and start over.\n\n\tvar cur_accum = 0;\n\tvar cur_bits = 0;\n\tvar masks = [0x0000, 0x0001, 0x0003, 0x0007, 0x000F, 0x001F, 0x003F, 0x007F, 0x00FF, 0x01FF, 0x03FF, 0x07FF, 0x0FFF, 0x1FFF, 0x3FFF, 0x7FFF, 0xFFFF];\n\n\t// Number of characters so far in this 'packet'\n\tvar a_count;\n\n\t// Define the storage for the packet accumulator\n\tvar accum = [];\n\n\tvar LZWEncoder = exports.LZWEncoder = function LZWEncoder(width, height, pixels, color_depth) {\n\t\timgW = width;\n\t\timgH = height;\n\t\tpixAry = pixels;\n\t\tinitCodeSize = Math.max(2, color_depth);\n\t};\n\n\t// Add a character to the end of the current packet, and if it is 254\n\t// characters, flush the packet to disk.\n\tvar char_out = function char_out(c, outs) {\n\t\taccum[a_count++] = c;\n\t\tif (a_count >= 254) flush_char(outs);\n\t};\n\n\t// Clear out the hash table\n\t// table clear for block compress\n\n\tvar cl_block = function cl_block(outs) {\n\t\tcl_hash(hsize);\n\t\tfree_ent = ClearCode + 2;\n\t\tclear_flg = true;\n\t\toutput(ClearCode, outs);\n\t};\n\n\t// reset code table\n\tvar cl_hash = function cl_hash(hsize) {\n\t\tfor (var i = 0; i < hsize; ++i) htab[i] = -1;\n\t};\n\n\tvar compress = exports.compress = function compress(init_bits, outs) {\n\n\t\tvar fcode;\n\t\tvar i; /* = 0 */\n\t\tvar c;\n\t\tvar ent;\n\t\tvar disp;\n\t\tvar hsize_reg;\n\t\tvar hshift;\n\n\t\t// Set up the globals: g_init_bits - initial number of bits\n\t\tg_init_bits = init_bits;\n\n\t\t// Set up the necessary values\n\t\tclear_flg = false;\n\t\tn_bits = g_init_bits;\n\t\tmaxcode = MAXCODE(n_bits);\n\n\t\tClearCode = 1 << (init_bits - 1);\n\t\tEOFCode = ClearCode + 1;\n\t\tfree_ent = ClearCode + 2;\n\n\t\ta_count = 0; // clear packet\n\n\t\tent = nextPixel();\n\n\t\thshift = 0;\n\t\tfor (fcode = hsize; fcode < 65536; fcode *= 2)\n\t\t\t++hshift;\n\t\thshift = 8 - hshift; // set hash code range bound\n\n\t\thsize_reg = hsize;\n\t\tcl_hash(hsize_reg); // clear hash table\n\n\t\toutput(ClearCode, outs);\n\n\t\touter_loop: while ((c = nextPixel()) != EOF) {\n\t\t\tfcode = (c << maxbits) + ent;\n\t\t\ti = (c << hshift) ^ ent; // xor hashing\n\n\t\t\tif (htab[i] == fcode) {\n\t\t\t\tent = codetab[i];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\telse if (htab[i] >= 0) { // non-empty slot\n\n\t\t\t\tdisp = hsize_reg - i; // secondary hash (after G. Knott)\n\t\t\t\tif (i === 0) disp = 1;\n\n\t\t\t\tdo {\n\t\t\t\t\tif ((i -= disp) < 0)\n\t\t\t\t\t\ti += hsize_reg;\n\n\t\t\t\t\tif (htab[i] == fcode) {\n\t\t\t\t\t\tent = codetab[i];\n\t\t\t\t\t\tcontinue outer_loop;\n\t\t\t\t\t}\n\t\t\t\t} while (htab[i] >= 0);\n\t\t\t}\n\n\t\t\toutput(ent, outs);\n\t\t\tent = c;\n\t\t\tif (free_ent < maxmaxcode) {\n\t\t\t\tcodetab[i] = free_ent++; // code -> hashtable\n\t\t\t\thtab[i] = fcode;\n\t\t\t}\n\t\t\telse cl_block(outs);\n\t\t}\n\n\t\t// Put out the final code.\n\t\toutput(ent, outs);\n\t\toutput(EOFCode, outs);\n\t};\n\n\t// ----------------------------------------------------------------------------\n\tvar encode = exports.encode = function encode(os) {\n\t\tos.writeByte(initCodeSize); // write \"initial code size\" byte\n\t\tremaining = imgW * imgH; // reset navigation variables\n\t\tcurPixel = 0;\n\t\tcompress(initCodeSize + 1, os); // compress and write the pixel data\n\t\tos.writeByte(0); // write block terminator\n\t};\n\n\t// Flush the packet to disk, and reset the accumulator\n\tvar flush_char = function flush_char(outs) {\n\t\tif (a_count > 0) {\n\t\t\touts.writeByte(a_count);\n\t\t\touts.writeBytes(accum, 0, a_count);\n\t\t\ta_count = 0;\n\t\t}\n\t};\n\n\tvar MAXCODE = function MAXCODE(n_bits) {\n\t\treturn (1 << n_bits) - 1;\n\t};\n\n\t// ----------------------------------------------------------------------------\n\t// Return the next pixel from the image\n\t// ----------------------------------------------------------------------------\n\n\tvar nextPixel = function nextPixel() {\n\t\tif (remaining === 0) return EOF;\n\t\t--remaining;\n\t\tvar pix = pixAry[curPixel++];\n\t\treturn pix & 0xff;\n\t};\n\n\tvar output = function output(code, outs) {\n\n\t\tcur_accum &= masks[cur_bits];\n\n\t\tif (cur_bits > 0) cur_accum |= (code << cur_bits);\n\t\telse cur_accum = code;\n\n\t\tcur_bits += n_bits;\n\n\t\twhile (cur_bits >= 8) {\n\t\t\tchar_out((cur_accum & 0xff), outs);\n\t\t\tcur_accum >>= 8;\n\t\t\tcur_bits -= 8;\n\t\t}\n\n\t\t// If the next entry is going to be too big for the code size,\n\t\t// then increase it, if possible.\n\n\t\tif (free_ent > maxcode || clear_flg) {\n\n\t\t\tif (clear_flg) {\n\n\t\t\t\tmaxcode = MAXCODE(n_bits = g_init_bits);\n\t\t\t\tclear_flg = false;\n\n\t\t\t} else {\n\n\t\t\t\t++n_bits;\n\t\t\t\tif (n_bits == maxbits) maxcode = maxmaxcode;\n\t\t\t\telse maxcode = MAXCODE(n_bits);\n\t\t\t}\n\t\t}\n\n\t\tif (code == EOFCode) {\n\n\t\t\t// At EOF, write the rest of the buffer.\n\t\t\twhile (cur_bits > 0) {\n\t\t\t\tchar_out((cur_accum & 0xff), outs);\n\t\t\t\tcur_accum >>= 8;\n\t\t\t\tcur_bits -= 8;\n\t\t\t}\n\n\t\t\tflush_char(outs);\n\t\t}\n\t};\n\n\tLZWEncoder.apply(this, arguments);\n\treturn exports;\n};\n\n/*\n * NeuQuant Neural-Net Quantization Algorithm\n * ------------------------------------------\n *\n * Copyright (c) 1994 Anthony Dekker\n *\n * NEUQUANT Neural-Net quantization algorithm by Anthony Dekker, 1994. See\n * \"Kohonen neural networks for optimal colour quantization\" in \"Network:\n * Computation in Neural Systems\" Vol. 5 (1994) pp 351-367. for a discussion of\n * the algorithm.\n *\n * Any party obtaining a copy of these files from the author, directly or\n * indirectly, is granted, free of charge, a full and unrestricted irrevocable,\n * world-wide, paid up, royalty-free, nonexclusive right and license to deal in\n * this software and documentation files (the \"Software\"), including without\n * limitation the rights to use, copy, modify, merge, publish, distribute,\n * sublicense, and/or sell copies of the Software, and to permit persons who\n * receive copies from any such party to do so, with the only requirement being\n * that this copyright notice remain intact.\n */\n\n/*\n * This class handles Neural-Net quantization algorithm\n * @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n * @author Thibault Imbert (AS3 version - bytearray.org)\n * @author Kevin Kwok (JavaScript version - https://github.com/antimatter15/jsgif)\n * @version 0.1 AS3 implementation\n */\n\nlet NeuQuant = function() {\n\n\tvar exports = {};\n\tvar netsize = 256; /* number of colours used */\n\n\t/* four primes near 500 - assume no image has a length so large */\n\t/* that it is divisible by all four primes */\n\n\tvar prime1 = 499;\n\tvar prime2 = 491;\n\tvar prime3 = 487;\n\tvar prime4 = 503;\n\tvar minpicturebytes = (3 * prime4); /* minimum size for input image */\n\n\t/*\n\t * Program Skeleton ---------------- [select samplefac in range 1..30] [read\n\t * image from input file] pic = (unsigned char*) malloc(3*width*height);\n\t * initnet(pic,3*width*height,samplefac); learn(); unbiasnet(); [write output\n\t * image header, using writecolourmap(f)] inxbuild(); write output image using\n\t * inxsearch(b,g,r)\n\t */\n\n\t/*\n\t * Network Definitions -------------------\n\t */\n\n\tvar maxnetpos = (netsize - 1);\n\tvar netbiasshift = 4; /* bias for colour values */\n\tvar ncycles = 100; /* no. of learning cycles */\n\n\t/* defs for freq and bias */\n\tvar intbiasshift = 16; /* bias for fractions */\n\tvar intbias = (1 << intbiasshift);\n\tvar gammashift = 10; /* gamma = 1024 */\n\tvar gamma = (1 << gammashift);\n\tvar betashift = 10;\n\tvar beta = (intbias >> betashift); /* beta = 1/1024 */\n\tvar betagamma = (intbias << (gammashift - betashift));\n\n\t/* defs for decreasing radius factor */\n\tvar initrad = (netsize >> 3); /* for 256 cols, radius starts */\n\tvar radiusbiasshift = 6; /* at 32.0 biased by 6 bits */\n\tvar radiusbias = (1 << radiusbiasshift);\n\tvar initradius = (initrad * radiusbias); /* and decreases by a */\n\tvar radiusdec = 30; /* factor of 1/30 each cycle */\n\n\t/* defs for decreasing alpha factor */\n\tvar alphabiasshift = 10; /* alpha starts at 1.0 */\n\tvar initalpha = (1 << alphabiasshift);\n\tvar alphadec; /* biased by 10 bits */\n\n\t/* radbias and alpharadbias used for radpower calculation */\n\tvar radbiasshift = 8;\n\tvar radbias = (1 << radbiasshift);\n\tvar alpharadbshift = (alphabiasshift + radbiasshift);\n\tvar alpharadbias = (1 << alpharadbshift);\n\n\t/*\n\t * Types and Global Variables --------------------------\n\t */\n\n\tvar thepicture; /* the input image itself */\n\tvar lengthcount; /* lengthcount = H*W*3 */\n\tvar samplefac; /* sampling factor 1..30 */\n\n\t// typedef int pixel[4]; /* BGRc */\n\tvar network; /* the network itself - [netsize][4] */\n\tvar netindex = [];\n\n\t/* for network lookup - really 256 */\n\tvar bias = [];\n\n\t/* bias and freq arrays for learning */\n\tvar freq = [];\n\tvar radpower = [];\n\n\tvar NeuQuant = exports.NeuQuant = function NeuQuant(thepic, len, sample) {\n\n\t\tvar i;\n\t\tvar p;\n\n\t\tthepicture = thepic;\n\t\tlengthcount = len;\n\t\tsamplefac = sample;\n\n\t\tnetwork = new Array(netsize);\n\n\t\tfor (i = 0; i < netsize; i++) {\n\n\t\t\tnetwork[i] = new Array(4);\n\t\t\tp = network[i];\n\t\t\tp[0] = p[1] = p[2] = (i << (netbiasshift + 8)) / netsize;\n\t\t\tfreq[i] = intbias / netsize; /* 1/netsize */\n\t\t\tbias[i] = 0;\n\t\t}\n\t};\n\n\tvar colorMap = function colorMap() {\n\n\t\tvar map = [];\n\t\tvar index = new Array(netsize);\n\n\t\tfor (var i = 0; i < netsize; i++)\n\t\t\tindex[network[i][3]] = i;\n\n\t\tvar k = 0;\n\t\tfor (var l = 0; l < netsize; l++) {\n\t\t\tvar j = index[l];\n\t\t\tmap[k++] = (network[j][0]);\n\t\t\tmap[k++] = (network[j][1]);\n\t\t\tmap[k++] = (network[j][2]);\n\t\t}\n\n\t\treturn map;\n\t};\n\n\t/*\n\t * Insertion sort of network and building of netindex[0..255] (to do after\n\t * unbias)\n\t * -------------------------------------------------------------------------------\n\t */\n\n\tvar inxbuild = function inxbuild() {\n\n\t\tvar i;\n\t\tvar j;\n\t\tvar smallpos;\n\t\tvar smallval;\n\t\tvar p;\n\t\tvar q;\n\t\tvar previouscol;\n\t\tvar startpos;\n\n\t\tpreviouscol = 0;\n\t\tstartpos = 0;\n\t\tfor (i = 0; i < netsize; i++) {\n\n\t\t\tp = network[i];\n\t\t\tsmallpos = i;\n\t\t\tsmallval = p[1]; /* index on g */\n\n\t\t\t/* find smallest in i..netsize-1 */\n\t\t\tfor (j = i + 1; j < netsize; j++) {\n\n\t\t\t\tq = network[j];\n\t\t\t\tif (q[1] < smallval) { /* index on g */\n\t\t\t\t\tsmallpos = j;\n\t\t\t\t\tsmallval = q[1]; /* index on g */\n\t\t\t\t}\n\t\t\t}\n\t\t\tq = network[smallpos];\n\n\t\t\t/* swap p (i) and q (smallpos) entries */\n\t\t\tif (i != smallpos) {\n\t\t\t\tj = q[0];\n\t\t\t\tq[0] = p[0];\n\t\t\t\tp[0] = j;\n\t\t\t\tj = q[1];\n\t\t\t\tq[1] = p[1];\n\t\t\t\tp[1] = j;\n\t\t\t\tj = q[2];\n\t\t\t\tq[2] = p[2];\n\t\t\t\tp[2] = j;\n\t\t\t\tj = q[3];\n\t\t\t\tq[3] = p[3];\n\t\t\t\tp[3] = j;\n\t\t\t}\n\n\t\t\t/* smallval entry is now in position i */\n\n\t\t\tif (smallval != previouscol) {\n\n\t\t\t\tnetindex[previouscol] = (startpos + i) >> 1;\n\n\t\t\t\tfor (j = previouscol + 1; j < smallval; j++) netindex[j] = i;\n\n\t\t\t\tpreviouscol = smallval;\n\t\t\t\tstartpos = i;\n\t\t\t}\n\t\t}\n\n\t\tnetindex[previouscol] = (startpos + maxnetpos) >> 1;\n\t\tfor (j = previouscol + 1; j < 256; j++) netindex[j] = maxnetpos; /* really 256 */\n\t};\n\n\t/*\n\t * Main Learning Loop ------------------\n\t */\n\n\tvar learn = function learn() {\n\n\t\tvar i;\n\t\tvar j;\n\t\tvar b;\n\t\tvar g;\n\t\tvar r;\n\t\tvar radius;\n\t\tvar rad;\n\t\tvar alpha;\n\t\tvar step;\n\t\tvar delta;\n\t\tvar samplepixels;\n\t\tvar p;\n\t\tvar pix;\n\t\tvar lim;\n\n\t\tif (lengthcount < minpicturebytes) samplefac = 1;\n\n\t\talphadec = 30 + ((samplefac - 1) / 3);\n\t\tp = thepicture;\n\t\tpix = 0;\n\t\tlim = lengthcount;\n\t\tsamplepixels = lengthcount / (3 * samplefac);\n\t\tdelta = (samplepixels / ncycles) | 0;\n\t\talpha = initalpha;\n\t\tradius = initradius;\n\n\t\trad = radius >> radiusbiasshift;\n\t\tif (rad <= 1) rad = 0;\n\n\t\tfor (i = 0; i < rad; i++) radpower[i] = alpha * (((rad * rad - i * i) * radbias) / (rad * rad));\n\n\t\tif (lengthcount < minpicturebytes) step = 3;\n\n\t\telse if ((lengthcount % prime1) !== 0) step = 3 * prime1;\n\n\t\telse {\n\n\t\t\tif ((lengthcount % prime2) !== 0) step = 3 * prime2;\n\t\t\telse {\n\t\t\t\tif ((lengthcount % prime3) !== 0) step = 3 * prime3;\n\t\t\t\telse step = 3 * prime4;\n\t\t\t}\n\t\t}\n\n\t\ti = 0;\n\t\twhile (i < samplepixels) {\n\n\t\t\tb = (p[pix + 0] & 0xff) << netbiasshift;\n\t\t\tg = (p[pix + 1] & 0xff) << netbiasshift;\n\t\t\tr = (p[pix + 2] & 0xff) << netbiasshift;\n\t\t\tj = contest(b, g, r);\n\n\t\t\taltersingle(alpha, j, b, g, r);\n\t\t\tif (rad !== 0) alterneigh(rad, j, b, g, r); /* alter neighbours */\n\n\t\t\tpix += step;\n\t\t\tif (pix >= lim) pix -= lengthcount;\n\n\t\t\ti++;\n\n\t\t\tif (delta === 0) delta = 1;\n\n\t\t\tif (i % delta === 0) {\n\t\t\t\talpha -= alpha / alphadec;\n\t\t\t\tradius -= radius / radiusdec;\n\t\t\t\trad = radius >> radiusbiasshift;\n\n\t\t\t\tif (rad <= 1) rad = 0;\n\n\t\t\t\tfor (j = 0; j < rad; j++) radpower[j] = alpha * (((rad * rad - j * j) * radbias) / (rad * rad));\n\t\t\t}\n\t\t}\n\t};\n\n\t/*\n\t ** Search for BGR values 0..255 (after net is unbiased) and return colour\n\t * index\n\t * ----------------------------------------------------------------------------\n\t */\n\n\tvar map = exports.map = function map(b, g, r) {\n\n\t\tvar i;\n\t\tvar j;\n\t\tvar dist;\n\t\tvar a;\n\t\tvar bestd;\n\t\tvar p;\n\t\tvar best;\n\n\t\tbestd = 1000; /* biggest possible dist is 256*3 */\n\t\tbest = -1;\n\t\ti = netindex[g]; /* index on g */\n\t\tj = i - 1; /* start at netindex[g] and work outwards */\n\n\t\twhile ((i < netsize) || (j >= 0)) {\n\n\t\t\tif (i < netsize) {\n\t\t\t\tp = network[i];\n\t\t\t\tdist = p[1] - g; /* inx key */\n\n\t\t\t\tif (dist >= bestd) i = netsize; /* stop iter */\n\n\t\t\t\telse {\n\n\t\t\t\t\ti++;\n\t\t\t\t\tif (dist < 0) dist = -dist;\n\t\t\t\t\ta = p[0] - b;\n\t\t\t\t\tif (a < 0) a = -a;\n\t\t\t\t\tdist += a;\n\n\t\t\t\t\tif (dist < bestd) {\n\t\t\t\t\t\ta = p[2] - r;\n\t\t\t\t\t\tif (a < 0) a = -a;\n\t\t\t\t\t\tdist += a;\n\n\t\t\t\t\t\tif (dist < bestd) {\n\t\t\t\t\t\t\tbestd = dist;\n\t\t\t\t\t\t\tbest = p[3];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (j >= 0) {\n\n\t\t\t\tp = network[j];\n\t\t\t\tdist = g - p[1]; /* inx key - reverse dif */\n\n\t\t\t\tif (dist >= bestd) j = -1; /* stop iter */\n\n\t\t\t\telse {\n\n\t\t\t\t\tj--;\n\t\t\t\t\tif (dist < 0) dist = -dist;\n\t\t\t\t\ta = p[0] - b;\n\t\t\t\t\tif (a < 0) a = -a;\n\t\t\t\t\tdist += a;\n\n\t\t\t\t\tif (dist < bestd) {\n\t\t\t\t\t\ta = p[2] - r;\n\t\t\t\t\t\tif (a < 0) a = -a;\n\t\t\t\t\t\tdist += a;\n\t\t\t\t\t\tif (dist < bestd) {\n\t\t\t\t\t\t\tbestd = dist;\n\t\t\t\t\t\t\tbest = p[3];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn (best);\n\t};\n\n\tvar process = exports.process = function process() {\n\t\tlearn();\n\t\tunbiasnet();\n\t\tinxbuild();\n\t\treturn colorMap();\n\t};\n\n\t/*\n\t * Unbias network to give byte values 0..255 and record position i to prepare\n\t * for sort\n\t * -----------------------------------------------------------------------------------\n\t */\n\n\tvar unbiasnet = function unbiasnet() {\n\n\t\tvar i;\n\t\tvar j;\n\n\t\tfor (i = 0; i < netsize; i++) {\n\t\t\tnetwork[i][0] >>= netbiasshift;\n\t\t\tnetwork[i][1] >>= netbiasshift;\n\t\t\tnetwork[i][2] >>= netbiasshift;\n\t\t\tnetwork[i][3] = i; /* record colour no */\n\t\t}\n\t};\n\n\t/*\n\t * Move adjacent neurons by precomputed alpha*(1-((i-j)^2/[r]^2)) in\n\t * radpower[|i-j|]\n\t * ---------------------------------------------------------------------------------\n\t */\n\n\tvar alterneigh = function alterneigh(rad, i, b, g, r) {\n\n\t\tvar j;\n\t\tvar k;\n\t\tvar lo;\n\t\tvar hi;\n\t\tvar a;\n\t\tvar m;\n\t\tvar p;\n\n\t\tlo = i - rad;\n\t\tif (lo < -1) lo = -1;\n\n\t\thi = i + rad;\n\t\tif (hi > netsize) hi = netsize;\n\n\t\tj = i + 1;\n\t\tk = i - 1;\n\t\tm = 1;\n\n\t\twhile ((j < hi) || (k > lo)) {\n\t\t\ta = radpower[m++];\n\n\t\t\tif (j < hi) {\n\t\t\t\tp = network[j++];\n\n\t\t\t\ttry {\n\t\t\t\t\tp[0] -= (a * (p[0] - b)) / alpharadbias;\n\t\t\t\t\tp[1] -= (a * (p[1] - g)) / alpharadbias;\n\t\t\t\t\tp[2] -= (a * (p[2] - r)) / alpharadbias;\n\t\t\t\t} catch (e) {} // prevents 1.3 miscompilation\n\t\t\t}\n\n\t\t\tif (k > lo) {\n\t\t\t\tp = network[k--];\n\n\t\t\t\ttry {\n\t\t\t\t\tp[0] -= (a * (p[0] - b)) / alpharadbias;\n\t\t\t\t\tp[1] -= (a * (p[1] - g)) / alpharadbias;\n\t\t\t\t\tp[2] -= (a * (p[2] - r)) / alpharadbias;\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\t\t}\n\t};\n\n\t/*\n\t * Move neuron i towards biased (b,g,r) by factor alpha\n\t * ----------------------------------------------------\n\t */\n\n\tvar altersingle = function altersingle(alpha, i, b, g, r) {\n\n\t\t/* alter hit neuron */\n\t\tvar n = network[i];\n\t\tn[0] -= (alpha * (n[0] - b)) / initalpha;\n\t\tn[1] -= (alpha * (n[1] - g)) / initalpha;\n\t\tn[2] -= (alpha * (n[2] - r)) / initalpha;\n\t};\n\n\t/*\n\t * Search for biased BGR values ----------------------------\n\t */\n\n\tvar contest = function contest(b, g, r) {\n\n\t\t/* finds closest neuron (min dist) and updates freq */\n\t\t/* finds best neuron (min dist-bias) and returns position */\n\t\t/* for frequently chosen neurons, freq[i] is high and bias[i] is negative */\n\t\t/* bias[i] = gamma*((1/netsize)-freq[i]) */\n\n\t\tvar i;\n\t\tvar dist;\n\t\tvar a;\n\t\tvar biasdist;\n\t\tvar betafreq;\n\t\tvar bestpos;\n\t\tvar bestbiaspos;\n\t\tvar bestd;\n\t\tvar bestbiasd;\n\t\tvar n;\n\n\t\tbestd = ~ (1 << 31);\n\t\tbestbiasd = bestd;\n\t\tbestpos = -1;\n\t\tbestbiaspos = bestpos;\n\n\t\tfor (i = 0; i < netsize; i++) {\n\t\t\tn = network[i];\n\t\t\tdist = n[0] - b;\n\t\t\tif (dist < 0) dist = -dist;\n\t\t\ta = n[1] - g;\n\t\t\tif (a < 0) a = -a;\n\t\t\tdist += a;\n\t\t\ta = n[2] - r;\n\t\t\tif (a < 0) a = -a;\n\t\t\tdist += a;\n\n\t\t\tif (dist < bestd) {\n\t\t\t\tbestd = dist;\n\t\t\t\tbestpos = i;\n\t\t\t}\n\n\t\t\tbiasdist = dist - ((bias[i]) >> (intbiasshift - netbiasshift));\n\n\t\t\tif (biasdist < bestbiasd) {\n\t\t\t\tbestbiasd = biasdist;\n\t\t\t\tbestbiaspos = i;\n\t\t\t}\n\n\t\t\tbetafreq = (freq[i] >> betashift);\n\t\t\tfreq[i] -= betafreq;\n\t\t\tbias[i] += (betafreq << gammashift);\n\t\t}\n\n\t\tfreq[bestpos] += beta;\n\t\tbias[bestpos] -= betagamma;\n\t\treturn (bestbiaspos);\n\t};\n\n\tNeuQuant.apply(this, arguments);\n\treturn exports;\n};\n\n/**\n * This class lets you encode animated GIF files\n * Base class :  http://www.java2s.com/Code/Java/2D-Graphics-GUI/AnimatedGifEncoder.htm\n * @author Kevin Weiner (original Java version - kweiner@fmsware.com)\n * @author Thibault Imbert (AS3 version - bytearray.org)\n * @author Kevin Kwok (JavaScript version - https://github.com/antimatter15/jsgif)\n * @version 0.1 AS3 implementation\n */\n\n export let GIFEncoder = function() {\n\n\tfor (var i = 0, chr = {}; i < 256; i++)\n\t\tchr[i] = String.fromCharCode(i);\n\n\tfunction ByteArray() {\n\t\tthis.bin = [];\n\t}\n\n\tByteArray.prototype.getData = function() {\n\t\tfor (var v = '', l = this.bin.length, i = 0; i < l; i++)\n\t\t\tv += chr[this.bin[i]];\n\t\treturn v;\n\t};\n\n\tByteArray.prototype.writeByte = function(val) {\n\t\tthis.bin.push(val);\n\t};\n\n\tByteArray.prototype.writeUTFBytes = function(string) {\n\t\tfor (var l = string.length, i = 0; i < l; i++)\n\t\t\tthis.writeByte(string.charCodeAt(i));\n\t};\n\n\tByteArray.prototype.writeBytes = function(array, offset, length) {\n\t\tfor (var l = length || array.length, i = offset || 0; i < l; i++)\n\t\t\tthis.writeByte(array[i]);\n\t};\n\n\tvar exports = {};\n\tvar width; // image size\n\tvar height;\n\tvar transparent = null; // transparent color if given\n\tvar transIndex; // transparent index in color table\n\tvar repeat = -1; // no repeat\n\tvar delay = 0; // frame delay (hundredths)\n\tvar started = false; // ready to output frames\n\tvar out;\n\tvar image; // current frame\n\tvar pixels; // BGR byte array from frame\n\tvar indexedPixels; // converted frame indexed to palette\n\tvar colorDepth; // number of bit planes\n\tvar colorTab; // RGB palette\n\tvar usedEntry = []; // active palette entries\n\tvar palSize = 7; // color table size (bits-1)\n\tvar dispose = -1; // disposal code (-1 = use default)\n\tvar closeStream = false; // close stream when finished\n\tvar firstFrame = true;\n\tvar sizeSet = false; // if false, get size from first frame\n\tvar sample = 10; // default sample interval for quantizer\n\tvar comment = \"Generated by jsgif (https://github.com/antimatter15/jsgif/)\"; // default comment for generated gif\n\n\t/**\n\t * Sets the delay time between each frame, or changes it for subsequent frames\n\t * (applies to last frame added)\n\t * int delay time in milliseconds\n\t * @param ms\n\t */\n\n\tvar setDelay = exports.setDelay = function setDelay(ms) {\n\t\tdelay = Math.round(ms / 10);\n\t};\n\n\t/**\n\t * Sets the GIF frame disposal code for the last added frame and any\n\t *\n\t * subsequent frames. Default is 0 if no transparent color has been set,\n\t * otherwise 2.\n\t * @param code\n\t * int disposal code.\n\t */\n\n\tvar setDispose = exports.setDispose = function setDispose(code) {\n\t\tif (code >= 0) dispose = code;\n\t};\n\n\t/**\n\t * Sets the number of times the set of GIF frames should be played. Default is\n\t * 1; 0 means play indefinitely. Must be invoked before the first image is\n\t * added.\n\t *\n\t * @param iter\n\t * int number of iterations.\n\t * @return\n\t */\n\n\tvar setRepeat = exports.setRepeat = function setRepeat(iter) {\n\t\tif (iter >= 0) repeat = iter;\n\t};\n\n\t/**\n\t * Sets the transparent color for the last added frame and any subsequent\n\t * frames. Since all colors are subject to modification in the quantization\n\t * process, the color in the final palette for each frame closest to the given\n\t * color becomes the transparent color for that frame. May be set to null to\n\t * indicate no transparent color.\n\t * @param\n\t * Color to be treated as transparent on display.\n\t */\n\n\tvar setTransparent = exports.setTransparent = function setTransparent(c) {\n\t\ttransparent = c;\n\t};\n\n\n\t/**\n\t * Sets the comment for the block comment\n\t * @param\n\t * string to be insterted as comment\n\t */\n\n\tvar setComment = exports.setComment = function setComment(c) {\n\t\tcomment = c;\n\t};\n\n\n\n\t/**\n\t * The addFrame method takes an incoming BitmapData object to create each frames\n\t * @param\n\t * BitmapData object to be treated as a GIF's frame\n\t */\n\n\tvar addFrame = exports.addFrame = function addFrame(im, is_imageData) {\n\n\t\tif ((im === null) || !started || out === null) {\n\t\t\tthrow new Error(\"Please call start method before calling addFrame\");\n\t\t}\n\n\t\tvar ok = true;\n\n\t\ttry {\n\t\t\tif (!is_imageData) {\n\t\t\t\timage = im.getImageData(0, 0, im.canvas.width, im.canvas.height).data;\n\t\t\t\tif (!sizeSet) setSize(im.canvas.width, im.canvas.height);\n\t\t\t} else {\n\t\t\t\tif(im instanceof ImageData) {\n\t\t\t\t\timage = im.data;\n\t\t\t\t\tif(!sizeSet || width!=im.width || height!=im.height) {\n\t\t\t\t\t\tsetSize(im.width,im.height);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t} else if(im instanceof Uint8ClampedArray) {\n\t\t\t\t\tif(im.length==(width*height*4)) {\n\t\t\t\t\t\timage=im;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log(\"Please set the correct size: ImageData length mismatch\");\n\t\t\t\t\t\tok=false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"Please provide correct input\");\n\t\t\t\t\tok=false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tgetImagePixels(); // convert to correct format if necessary\n\t\t\tanalyzePixels(); // build color table & map pixels\n\n\t\t\tif (firstFrame) {\n\t\t\t\twriteLSD(); // logical screen descriptior\n\t\t\t\twritePalette(); // global color table\n\t\t\t\tif (repeat >= 0) {\n\t\t\t\t\t// use NS app extension to indicate reps\n\t\t\t\t\twriteNetscapeExt();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twriteGraphicCtrlExt(); // write graphic control extension\n\t\t\tif (comment !== '') {\n\t\t\t\twriteCommentExt(); // write comment extension\n\t\t\t}\n\t\t\twriteImageDesc(); // image descriptor\n\t\t\tif (!firstFrame) writePalette(); // local color table\n\t\t\twritePixels(); // encode and write pixel data\n\t\t\tfirstFrame = false;\n\t\t} catch (e) {\n\t\t\tok = false;\n\t\t}\n\n\t\treturn ok;\n\t};\n\t\n\t/**\n\t* @description: Downloads the encoded gif with the given name\n\t* No need of any conversion from the stream data (out) to base64\n\t* Solves the issue of large file sizes when there are more frames\n\t* and does not involve in creation of any temporary data in the process\n\t* so no wastage of memory, and speeds up the process of downloading\n\t* to just calling this function.\n\t* @parameter {String} filename filename used for downloading the gif\n\t*/\n\t\n\tvar download = exports.download = function download(filename) {\n\t\tif(out===null || closeStream==false) {\n\t\t\tconsole.log(\"Please call start method and add frames and call finish method before calling download\"); \n\t\t} else {\n\t\t\tfilename= filename !== undefined ? ( filename.endsWith(\".gif\")? filename: filename+\".gif\" ): \"download.gif\";\n\t\t\tvar templink = document.createElement(\"a\");\n\t\t\ttemplink.download=filename;\n\t\t\ttemplink.href= URL.createObjectURL(new Blob([new Uint8Array(out.bin)], {type : \"image/gif\" } ));\n\t\t\ttemplink.click();\n\t\t}\n\t}\n\n\t/**\n\t * Adds final trailer to the GIF stream, if you don't call the finish method\n\t * the GIF stream will not be valid.\n\t */\n\n\tvar finish = exports.finish = function finish() {\n\n\t\tif (!started) return false;\n\n\t\tvar ok = true;\n\t\tstarted = false;\n\n\t\ttry {\n\t\t\tout.writeByte(0x3b); // gif trailer\n\t\t\tcloseStream=true;\n\t\t} catch (e) {\n\t\t\tok = false;\n\t\t}\n\n\t\treturn ok;\n\t};\n\n\t/**\n\t * Resets some members so that a new stream can be started.\n\t * This method is actually called by the start method\n\t */\n\n\tvar reset = function reset() {\n\n\t\t// reset for subsequent use\n\t\ttransIndex = 0;\n\t\timage = null;\n\t\tpixels = null;\n\t\tindexedPixels = null;\n\t\tcolorTab = null;\n\t\tcloseStream = false;\n\t\tfirstFrame = true;\n\t};\n\n\t/**\n\t * * Sets frame rate in frames per second. Equivalent to\n\t * <code>setDelay(1000/fps)</code>.\n\t * @param fps\n\t * float frame rate (frames per second)\n\t */\n\n\tvar setFrameRate = exports.setFrameRate = function setFrameRate(fps) {\n\t\tif (fps != 0xf) delay = Math.round(100 / fps);\n\t};\n\n\t/**\n\t * Sets quality of color quantization (conversion of images to the maximum 256\n\t * colors allowed by the GIF specification). Lower values (minimum = 1)\n\t * produce better colors, but slow processing significantly. 10 is the\n\t * default, and produces good color mapping at reasonable speeds. Values\n\t * greater than 20 do not yield significant improvements in speed.\n\t * @param quality\n\t * int greater than 0.\n\t * @return\n\t */\n\n\tvar setQuality = exports.setQuality = function setQuality(quality) {\n\t\tif (quality < 1) quality = 1;\n\t\tsample = quality;\n\t};\n\n\t/**\n\t * Sets the GIF frame size. The default size is the size of the first frame\n\t * added if this method is not invoked.\n\t * @param w\n\t * int frame width.\n\t * @param h\n\t * int frame width.\n\t */\n\n\tvar setSize = exports.setSize = function setSize(w, h) {\n\n\t\tif (started && !firstFrame) return;\n\t\twidth = w;\n\t\theight = h;\n\t\tif (width < 1) width = 320;\n\t\tif (height < 1) height = 240;\n\t\tsizeSet = true;\n\t};\n\n\t/**\n\t * Initiates GIF file creation on the given stream.\n\t * @param os\n\t * OutputStream on which GIF images are written.\n\t * @return false if initial write failed.\n\t */\n\n\tvar start = exports.start = function start() {\n\n\t\treset();\n\t\tvar ok = true;\n\t\tcloseStream = false;\n\t\tout = new ByteArray();\n\t\ttry {\n\t\t\tout.writeUTFBytes(\"GIF89a\"); // header\n\t\t} catch (e) {\n\t\t\tok = false;\n\t\t}\n\n\t\treturn started = ok;\n\t};\n\n\tvar cont = exports.cont = function cont() {\n\n\t\treset();\n\t\tvar ok = true;\n\t\tcloseStream = false;\n\t\tout = new ByteArray();\n\n\t\treturn started = ok;\n\t};\n\n\t/**\n\t * Analyzes image colors and creates color map.\n\t */\n\n\tvar analyzePixels = function analyzePixels() {\n\n\t\tvar len = pixels.length;\n\t\tvar nPix = len / 3;\n\t\tindexedPixels = [];\n\t\tvar nq = new NeuQuant(pixels, len, sample);\n\n\t\t// initialize quantizer\n\t\tcolorTab = nq.process(); // create reduced palette\n\n\t\t// map image pixels to new palette\n\t\tvar k = 0;\n\t\tfor (var j = 0; j < nPix; j++) {\n\t\t\tvar index = nq.map(pixels[k++] & 0xff, pixels[k++] & 0xff, pixels[k++] & 0xff);\n\t\t\tusedEntry[index] = true;\n\t\t\tindexedPixels[j] = index;\n\t\t}\n\n\t\tpixels = null;\n\t\tcolorDepth = 8;\n\t\tpalSize = 7;\n\n\t\t// get closest match to transparent color if specified\n\t\tif (transparent !== null) {\n\t\t\ttransIndex = findClosest(transparent);\n\t\t}\n\t};\n\n\t/**\n\t * Returns index of palette color closest to c\n\t */\n\n\tvar findClosest = function findClosest(c) {\n\n\t\tif (colorTab === null) return -1;\n\t\tvar r = (c & 0xFF0000) >> 16;\n\t\tvar g = (c & 0x00FF00) >> 8;\n\t\tvar b = (c & 0x0000FF);\n\t\tvar minpos = 0;\n\t\tvar dmin = 256 * 256 * 256;\n\t\tvar len = colorTab.length;\n\n\t\tfor (var i = 0; i < len;) {\n\t\t\tvar dr = r - (colorTab[i++] & 0xff);\n\t\t\tvar dg = g - (colorTab[i++] & 0xff);\n\t\t\tvar db = b - (colorTab[i] & 0xff);\n\t\t\tvar d = dr * dr + dg * dg + db * db;\n\t\t\tvar index = i / 3;\n\t\t\tif (usedEntry[index] && (d < dmin)) {\n\t\t\t\tdmin = d;\n\t\t\t\tminpos = index;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\treturn minpos;\n\t};\n\n\t/**\n\t * Extracts image pixels into byte array \"pixels\n\t */\n\n\tvar getImagePixels = function getImagePixels() {\n\t\tvar w = width;\n\t\tvar h = height;\n\t\tpixels = [];\n\t\tvar data = image;\n\t\tvar count = 0;\n\n\t\tfor (var i = 0; i < h; i++) {\n\n\t\t\tfor (var j = 0; j < w; j++) {\n\n\t\t\t\tvar b = (i * w * 4) + j * 4;\n\t\t\t\tpixels[count++] = data[b];\n\t\t\t\tpixels[count++] = data[b + 1];\n\t\t\t\tpixels[count++] = data[b + 2];\n\n\t\t\t}\n\n\t\t}\n\t};\n\n\t/**\n\t * Writes Graphic Control Extension\n\t */\n\n\tvar writeGraphicCtrlExt = function writeGraphicCtrlExt() {\n\t\tout.writeByte(0x21); // extension introducer\n\t\tout.writeByte(0xf9); // GCE label\n\t\tout.writeByte(4); // data block size\n\t\tvar transp;\n\t\tvar disp;\n\t\tif (transparent === null) {\n\t\t\ttransp = 0;\n\t\t\tdisp = 0; // dispose = no action\n\t\t} else {\n\t\t\ttransp = 1;\n\t\t\tdisp = 2; // force clear if using transparent color\n\t\t}\n\t\tif (dispose >= 0) {\n\t\t\tdisp = dispose & 7; // user override\n\t\t}\n\t\tdisp <<= 2;\n\t\t// packed fields\n\t\tout.writeByte(0 | // 1:3 reserved\n\t\t\tdisp | // 4:6 disposal\n\t\t\t0 | // 7 user input - 0 = none\n\t\t\ttransp); // 8 transparency flag\n\n\t\tWriteShort(delay); // delay x 1/100 sec\n\t\tout.writeByte(transIndex); // transparent color index\n\t\tout.writeByte(0); // block terminator\n\t};\n\n\t/**\n\t * Writes Comment Extention\n\t */\n\n\tvar writeCommentExt = function writeCommentExt() {\n\t\tout.writeByte(0x21); // extension introducer\n\t\tout.writeByte(0xfe); // comment label\n\t\tout.writeByte(comment.length); // Block Size (s)\n\t\tout.writeUTFBytes(comment);\n\t\tout.writeByte(0); // block terminator\n\t};\n\n\n\t/**\n\t * Writes Image Descriptor\n\t */\n\n\tvar writeImageDesc = function writeImageDesc() {\n\n\t\tout.writeByte(0x2c); // image separator\n\t\tWriteShort(0); // image position x,y = 0,0\n\t\tWriteShort(0);\n\t\tWriteShort(width); // image size\n\t\tWriteShort(height);\n\n\t\t// packed fields\n\t\tif (firstFrame) {\n\t\t\t// no LCT - GCT is used for first (or only) frame\n\t\t\tout.writeByte(0);\n\t\t} else {\n\t\t\t// specify normal LCT\n\t\t\tout.writeByte(0x80 | // 1 local color table 1=yes\n\t\t\t\t0 | // 2 interlace - 0=no\n\t\t\t\t0 | // 3 sorted - 0=no\n\t\t\t\t0 | // 4-5 reserved\n\t\t\t\tpalSize); // 6-8 size of color table\n\t\t}\n\t};\n\n\t/**\n\t * Writes Logical Screen Descriptor\n\t */\n\n\tvar writeLSD = function writeLSD() {\n\n\t\t// logical screen size\n\t\tWriteShort(width);\n\t\tWriteShort(height);\n\t\t// packed fields\n\t\tout.writeByte((0x80 | // 1 : global color table flag = 1 (gct used)\n\t\t\t0x70 | // 2-4 : color resolution = 7\n\t\t\t0x00 | // 5 : gct sort flag = 0\n\t\t\tpalSize)); // 6-8 : gct size\n\n\t\tout.writeByte(0); // background color index\n\t\tout.writeByte(0); // pixel aspect ratio - assume 1:1\n\t};\n\n\t/**\n\t * Writes Netscape application extension to define repeat count.\n\t */\n\n\tvar writeNetscapeExt = function writeNetscapeExt() {\n\t\tout.writeByte(0x21); // extension introducer\n\t\tout.writeByte(0xff); // app extension label\n\t\tout.writeByte(11); // block size\n\t\tout.writeUTFBytes(\"NETSCAPE\" + \"2.0\"); // app id + auth code\n\t\tout.writeByte(3); // sub-block size\n\t\tout.writeByte(1); // loop sub-block id\n\t\tWriteShort(repeat); // loop count (extra iterations, 0=repeat forever)\n\t\tout.writeByte(0); // block terminator\n\t};\n\n\t/**\n\t * Writes color table\n\t */\n\n\tvar writePalette = function writePalette() {\n\t\tout.writeBytes(colorTab);\n\t\tvar n = (3 * 256) - colorTab.length;\n\t\tfor (var i = 0; i < n; i++) out.writeByte(0);\n\t};\n\n\tvar WriteShort = function WriteShort(pValue) {\n\t\tout.writeByte(pValue & 0xFF);\n\t\tout.writeByte((pValue >> 8) & 0xFF);\n\t};\n\n\t/**\n\t * Encodes and writes pixel data\n\t */\n\n\tvar writePixels = function writePixels() {\n\t\tvar myencoder = new LZWEncoder(width, height, indexedPixels, colorDepth);\n\t\tmyencoder.encode(out);\n\t};\n\n\t/**\n\t * Retrieves the GIF stream\n\t */\n\n\tvar stream = exports.stream = function stream() {\n\t\treturn out;\n\t};\n\n\tvar setProperties = exports.setProperties = function setProperties(has_start, is_first) {\n\t\tstarted = has_start;\n\t\tfirstFrame = is_first;\n\t};\n\n\treturn exports;\n\n};","import React from 'react'\nimport FlipbookContext from '../context'\nimport IconButton from './IconButton'\nimport { layers, clearUndoRedoStacks, botCanvas } from '../drawData'\nimport './BottomBar.css'\nimport leftArrowIcon from '../icons/left-arrow.png'\nimport rightArrowIcon from '../icons/right-arrow.png'\nimport plusIcon from '../icons/plus.png'\nimport xIcon from '../icons/X.png'\n\nimport { GIFEncoder } from '../gif'\n\nlet framesPerSecond = 1;\n\nconst BottomBar = () => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    const addFrame = () => {\n        let newState = Object.assign({}, globalState);\n        layers.splice(globalState.curFrame + 1, 0, [{\n            id: globalState.newLayerId,\n            imgData: null,\n            hidden: false,\n            name: 'Layer ' + globalState.newLayerId,\n            opacity: 100\n        }]);\n        newState.curFrame++;\n        newState.newLayerId++;\n        newState.curLayer = 0;\n        clearUndoRedoStacks();\n        drawFrame(botCanvas.ref.current, globalState.curFrame);\n        setGlobalState(newState);\n    }\n\n    const removeFrame = () => {\n        if (layers.length === 1) return;\n        if (!window.confirm('Permanently delete this frame?')) return;\n        let newState = Object.assign({}, globalState);\n        layers.splice(globalState.curFrame, 1);\n        if (globalState.curFrame === layers.length) {\n            newState.curFrame--;\n            drawFrame(botCanvas.ref.current, globalState.curFrame - 2);\n        }\n        else {\n            drawFrame(botCanvas.ref.current, globalState.curFrame - 1);\n        }\n        newState.newLayerId++;\n        newState.curLayer = 0;\n        setGlobalState(newState);\n        clearUndoRedoStacks();\n    }\n\n    const prevFrame = () => {\n        if (globalState.curFrame === 0) return;\n        let newState = Object.assign({}, globalState);\n        newState.curFrame--;\n        newState.curLayer = 0;\n        clearUndoRedoStacks();\n        drawFrame(botCanvas.ref.current, globalState.curFrame - 2);\n        setGlobalState(newState);\n    }\n\n    const nextFrame = () => {\n        if (globalState.curFrame === layers.length - 1) return;\n        let newState = Object.assign({}, globalState);\n        newState.curFrame++;\n        newState.curLayer = 0;\n        clearUndoRedoStacks();\n        drawFrame(botCanvas.ref.current, globalState.curFrame);\n        setGlobalState(newState);\n    }\n\n    const drawFrame = (canvas, frameIndex) => {\n        let ctx = canvas.getContext('2d');\n\n        let tempCanvas = document.createElement(\"canvas\");\n        tempCanvas.width = canvas.width;\n        tempCanvas.height = canvas.height;\n\n        ctx.fillStyle = 'white';\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        if (frameIndex < 0) return;\n\n        for (let lyrIndex = layers[frameIndex].length - 1; lyrIndex >= 0; lyrIndex--) {\n            let lyr = layers[frameIndex][lyrIndex];\n            if (lyr.imgData && !lyr.hidden) {\n                ctx.globalAlpha = lyr.opacity / 100;\n                tempCanvas.getContext('2d').putImageData(layers[frameIndex][lyrIndex].imgData, 0, 0);\n                canvas.getContext('2d').drawImage(tempCanvas, 0, 0);\n            }\n        }\n    }\n\n    const createGIF = () => {\n        let encoder = GIFEncoder();\n        let delay = (1 / framesPerSecond) * 1000;\n        encoder.setQuality(1);\n        encoder.setRepeat(0);\n        encoder.setDelay(delay);\n        encoder.start();\n\n        let offScreenCanvas = document.createElement(\"canvas\");\n        let osctx = offScreenCanvas.getContext('2d');\n        offScreenCanvas.width = botCanvas.ref.current.width;\n        offScreenCanvas.height = botCanvas.ref.current.height;\n\n        for (let frame = 0; frame < layers.length; frame++) {\n            drawFrame(offScreenCanvas, frame);\n            encoder.addFrame(osctx);\n        }\n\n        encoder.finish();\n        let binary_gif = encoder.stream().getData()\n        let data_url = 'data:image/gif;base64,' + btoa(binary_gif);\n\n        let newState = Object.assign({}, globalState);\n        newState.gifOpen = true;\n        newState.gifSrc = data_url;\n        setGlobalState(newState);\n    }\n\n    return (\n        <div id='bottombarContainer'>\n\n            <div id='topRow'>\n                <IconButton btnTitle='Add frame after current frame' imgSrc={plusIcon} onClick_p={addFrame}\n                    size={40} selected={false} />\n\n                <span id='chooseFrame'>\n                    <IconButton btnTitle='Last Frame' imgSrc={leftArrowIcon} onClick_p={prevFrame}\n                        size={40} selected={false} />\n\n                    <span id='frameNum'>frame {globalState.curFrame + 1}/{layers.length}</span>\n\n                    <IconButton btnTitle='Next Frame' imgSrc={rightArrowIcon} onClick_p={nextFrame}\n                        size={40} selected={false} />\n                </span>\n\n                <IconButton btnTitle='Remove current frame' imgSrc={xIcon} onClick_p={removeFrame}\n                    size={40} selected={false} />\n            </div>\n\n            <label>Frames per second:</label>\n            <input type='number' id='fps' name='fps' defaultValue={framesPerSecond} min={1}\n                onChange={(e) => { framesPerSecond = e.target.value; }} />\n\n            <button onClick={createGIF}>Create GIF</button>\n\n        </div>\n    );\n}\n\nexport default BottomBar;","import React from 'react';\nimport './CanvasForm.css'\n\nconst CanvasForm = ({ createCanvas_p }) => {\n\n    let inputWidth = 500;\n    let inputHeight = 500;\n\n    return (\n        <div id='canvasForm'>\n            <h1>Canvas Size</h1>\n            <p>Width:  </p>\n            <input type='number' defaultValue={500} onChange={(e) => inputWidth = e.target.value} />\n            <p> px</p>\n            <br />\n            <p>Height:  </p>\n            <input type='number' defaultValue={500} onChange={(e) => inputHeight = e.target.value} />\n            <p> px</p>\n            <br />\n            <button onClick={() => createCanvas_p(inputWidth, inputHeight)}>Create Canvas</button>\n        </div>\n    );\n}\n\nexport default CanvasForm;","import React from 'react'\nimport FlipbookContext from '../context'\nimport { tools, isDrawing } from '../drawData'\n\nconst Layer = ({ imgData, setImgData, width, height, top, left, zIndex, hidden, opacity }) => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    const canvRef = React.useRef();\n\n    React.useEffect(() => {\n        let ctx = canvRef.current.getContext('2d');\n        if (ctx) {\n            if (!isDrawing && imgData !== null) {\n                ctx.putImageData(imgData, 0, 0);\n            }\n        }\n    });\n\n    return (\n        <canvas ref={canvRef} className='layer'\n            width={width * window.devicePixelRatio}\n            height={height * window.devicePixelRatio}\n\n            onPointerDown={(event) => {\n                if (!canvRef.current) return;\n\n                event.preventDefault();\n\n                let ctx = canvRef.current.getContext('2d');\n                ctx.strokeStyle = globalState.selectedColor;\n                ctx.lineWidth = globalState.selectedSize;\n\n                let res = tools[globalState.selectedTool].startPath(event, canvRef.current);\n                if (globalState.selectedTool === 'Dropper') {\n                    let newState = Object.assign({}, globalState);\n                    newState.selectedColor = res;\n                    setGlobalState(newState);\n                }\n            }}\n\n            onPointerMove={(event) => {\n                if (!canvRef.current) return;\n                event.preventDefault();\n                tools[globalState.selectedTool].draw(event, canvRef.current);\n            }}\n\n            onPointerUp={(event) => {\n                if (!canvRef.current) return;\n                event.preventDefault();\n                let ctx = canvRef.current.getContext('2d');\n                tools[globalState.selectedTool].endPath();\n                setImgData(ctx.getImageData(0, 0, width, height));\n            }}\n\n            onPointerOut={(event) => {\n                if (!canvRef.current) return;\n                event.preventDefault();\n                let ctx = canvRef.current.getContext('2d');\n                tools[globalState.selectedTool].endPath();\n                setImgData(ctx.getImageData(0, 0, width, height));\n            }}\n\n            style={{\n                position: 'absolute',\n                width: width,\n                height: height,\n                top: top + window.scrollY,\n                left: left + window.scrollX,\n                zIndex: zIndex,\n                pointerEvents: (zIndex === 0) ? 'all' : 'none',\n                visibility: hidden ? 'hidden' : 'visible',\n                opacity: opacity / 100,\n            }} />);\n}\n\nexport default Layer;","import React from 'react'\nimport './DrawingArea.css'\nimport FlipbookContext from '../context'\nimport { layers, botCanvas } from '../drawData'\nimport Layer from './Layer'\nimport _debounce from 'lodash.debounce'\n\nconst DrawingArea = ({ width, height, botCanvasOpacity }) => {\n\n    const { globalState, setGlobalState } = React.useContext(FlipbookContext);\n\n    botCanvas.ref = React.useRef();\n\n    const handleResize = () => {\n        _debounce(() => {\n            let rect = botCanvas.ref.current.getBoundingClientRect();\n            let newState = Object.assign({}, globalState);\n            newState.botCanvasTop = rect.top;\n            newState.botCanvasLeft = rect.left;\n            newState.botCanvasRight = rect.right;\n            setGlobalState(newState);\n        }, 100)();\n    }\n\n    React.useEffect(() => {\n        handleResize();\n    }, []);\n\n    React.useEffect(() => {\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    });\n\n    return (\n        <div id='canvasContainer'>\n            {layers.map((frame, frameIndex) =>\n                layers[globalState.curFrame].map(({ id, imgData, hasNewData, hidden, name, opacity }, lyrIndex) =>\n                    <Layer\n                        key={id}\n                        imgData={imgData}\n                        hasNewData={hasNewData}\n                        setImgData={(newData) => {\n                            layers[globalState.curFrame][globalState.curLayer].imgData = newData;\n                        }}\n                        width={width}\n                        height={height}\n                        top={globalState.botCanvasTop}\n                        left={globalState.botCanvasLeft}\n                        zIndex={(globalState.curLayer - lyrIndex)}\n                        hidden={hidden || (frameIndex !== globalState.curFrame)}\n                        opacity={opacity}\n                    />))}\n\n            <canvas id=\"bottomCanvas\" ref={botCanvas.ref}\n                width={width * window.devicePixelRatio}\n                height={height * window.devicePixelRatio}\n\n                style={{\n                    position: 'relative',\n                    width: width,\n                    height: height,\n                    opacity: botCanvasOpacity / 100,\n                    zIndex: -100,\n                    display: 'table',\n                    margin: 'auto'\n                }} />\n        </div>\n    );\n\n}\n\nexport default DrawingArea;","import React from 'react'\nimport './Flipbook.css'\nimport FlipbookContext from '../context'\nimport CompletedGIF from './CompletedGIF'\nimport Toolbar from './Toolbar'\nimport UndoRedoBar from './UndoRedoBar.js'\nimport Sidebar from './Sidebar'\nimport BottomBar from './BottomBar'\nimport CanvasForm from './CanvasForm'\nimport DrawingArea from './DrawingArea'\n\nconst Flipbook = () => {\n\n    const [globalState, setGlobalState] = React.useState({\n        canvasOpen: false,\n        gifOpen: false,\n        canvasWidth: 0,\n        canvasHeight: 0,\n        selectedTool: 'Pencil',\n        selectedColor: '#000000',\n        selectedSize: 1,\n        curLayer: 0,\n        curFrame: 0,\n        newLayerId: 1,\n        botCanvasOpacity: 20,\n        botCanvasTop: 0,\n        botCanvasLeft: 0,\n        botCanvasRight: 0,\n        gifSrc: ''\n    });\n\n    const createCanvas = (width, height) => {\n        let newState = Object.assign({}, globalState);\n        newState.canvasOpen = true;\n        newState.canvasWidth = width;\n        newState.canvasHeight = height;\n        setGlobalState(newState);\n    }\n\n    if (globalState.canvasOpen)\n        return (\n            <FlipbookContext.Provider value={{ globalState, setGlobalState }}>\n                <div id='topLevelContainer'>\n                    <div id='leftBar'>\n                        <Toolbar />\n                        <hr />\n                        <UndoRedoBar />\n                    </div>\n                    <DrawingArea width={globalState.canvasWidth} height={globalState.canvasHeight}\n                        botCanvasOpacity={globalState.botCanvasOpacity} />\n                    <Sidebar />\n                    <BottomBar />\n                    {globalState.gifOpen ? <CompletedGIF gifSrc={globalState.gifSrc}/> : ''}\n                </div>\n            </FlipbookContext.Provider>\n        );\n    else\n        return (\n            <CanvasForm createCanvas_p={createCanvas} />\n        );\n}\n\nexport default Flipbook","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Flipbook from './components/Flipbook'\n\nconst App = () => <Flipbook />\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}